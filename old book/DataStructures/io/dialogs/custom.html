<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Custom Dialogs</title>
<link href="/~rhowell/style.css" rel="STYLESHEET"/>
</head>
<body>
<h1>Custom Dialogs</h1>

While the dialogs provided by the .NET Framework are useful in a
    variety of applications, there are times when we need to be able
    to design our own special-purpose dialog to obtain specific
    information from the user.  This section outlines how Visual
    Studio® can be used to build such a dialog.
<p>
Let's begin by considering a simple example.  Suppose we are building
      an application that needs a dialog to obtain from the user the
      following pieces of information:
</p>
<ul>
<li> a name; </li>
<li> a phone number; and </li>
<li> a number of siblings. </li>
</ul>
In order to keep the example simple, the program will simply display
    this information in its main window.  Thus, the main window looks
    like this:
<p>
<img alt="A window that uses a custom dialog" src="custom-dialog-main.jpg"/>
</p>
Clicking the "Get New Information" button will open our custom dialog,
    which will look like this:
<p>
<img alt="A custom dialog" src="custom-dialog.jpg"/>
</p>
After the user enters the information, clicking "OK" will cause the
    information entered to be displayed in the main window.  If the
    user clicks "Cancel", the main window will be unchanged.
<p>
After building the main form in Visual Studio's Design Window, we can
      build the dialog by creating another form.  To do this, in the
      Solution Explorer, right-click on the project name and select
      "AddÃ¢â‚¬â€˜&gt;Windows Form...".  This will open a dialog
      for adding a new item, where the type of item is pre-selected to
      be a Windows Form.  You will need to supply a name for the
      form.  This name will serve as both a file name for a source
      file and the name of a class defined within this file.  For
      example, we could choose the name, "InformationDialog.cs", and
      the class will be named <b>InformationDialog</b>.  Clicking the
      "Add" button will then open a new Design Window containing a
      form.
</p>
We can then use the Design Window to build this form as we would build
    any other form.  In addition, the <b>Button</b> class has a <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.button.dialogresult(v=vs.110).aspx"><b>DialogResult</b></a>
    property
    that governs certain behavior when buttons are used within a
    dialog.  This property is of type <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.dialogresult(v=vs.110).aspx"><b>DialogResult</b></a>.
    Setting it to a value other than
    <b>None</b> will cause the button to do the following
    when clicked, provided the form is displayed as a <a href="/~rhowell/DataStructures/redirect/dialogs">modal dialog</a>:
<ul>
<li> Close the form. </li>
<li> Return the value of the <b>DialogResult</b> property. </li>
</ul>
Thus, we should set the "OK" button's <b>DialogResult</b> property to
    <b>OK</b> and the "Cancel" button's <b>DialogResult</b> property
    to <b>Cancel</b>.  Once we have done this, there is no need
    to define any event handlers for these buttons.
<p>
Furthermore, the <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.form(v=vs.110).aspx"><b>Form</b></a>
      itself has two properties that can be set to provide shortcuts
	for these buttons.  The <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.form.acceptbutton(v=vs.110).aspx"><b>AcceptButton</b></a>
	property, of type <b>IButtonControl</b> (a super-type of
	<b>Button</b>), can be used to cause the "Enter" key to
	activate a button on the form, as if that button had been
	clicked.  Thus, we could set this property to the "OK"
	button.  Similarly, the <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.form.cancelbutton(v=vs.110).aspx"><b>CancelButton</b></a>
	property (also of type <b>IButtonControl</b>) can be used to
	cause the "Esc" key to activate a button on the form.  We
	could therefore set this property to the "Cancel" button.
</p>
While we don't need any event handlers for this dialog, we still need
    to provide code to allow the class for the main window to access
    the values provided by the user.   This can be accomplished with
    three <b>public</b> <a href="/~rhowell/DataStructures/redirect/properties">properties</a>,
    one for each of the three pieces of information the user can
    provide:
<pre>
/// &lt;summary&gt;
/// Gets the name.  (There is already a Name property inherited from
/// the Form class, so we will use FullName.)
/// &lt;/summary&gt;
public string FullName
{
    get
    {
        return uxName.Text;
    }
}

/// &lt;summary&gt;
/// Gets the phone number.
/// &lt;/summary&gt;
public string PhoneNumber
{
    get
    {
        return uxPhoneNumber.Text;
    }
}

/// &lt;summary&gt;
/// Gets the number of siblings.
/// &lt;/summary&gt;
public int Siblings
{
    get
    {
        return (int)uxSiblings.Value;
    }
}
</pre>
In order for the main window to be able to display this dialog, it
    needs to construct an instance of it.  We can add to its class
    definition a <b>private</b> field initialized to such an instance:
<pre>
/// &lt;summary&gt;
/// The dialog for obtaining information from the user.
/// &lt;/summary&gt;
private InformationDialog uxInformation = new InformationDialog();
</pre>
Finally, we need an event handler for the "Get New Information"
    button.  This event handler needs to display the
    <b>InformationDialog</b> as a modal dialog, and if the user closes
    it with the "OK" button, to copy the information provided by the
    user to the main window.  A <b>Form</b> provides two methods for
    displaying it as a dialog:
<ul>
<li> <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.control.show(v=vs.110).aspx"><b>Show</b></a>
	  displays the <b>Form</b> as a <a href="/~rhowell/DataStructures/redirect/dialogs">non-modal
	  dialog</a>.  It takes no 
	  parameters and returns nothing.</li>
<li> <a href="http://msdn.microsoft.com/en-us/library/c7ykbedk(v=vs.110).aspx"><b>ShowDialog</b></a>
	  displays the <b>Form</b> as a <a href="/~rhowell/DataStructures/redirect/dialogs">modal
	  dialog</a>.  It takes no parameters and returns a
	  <b>DialogResult</b> indicating how the user closed the
	  dialog. </li>
</ul>
Thus, the event handler can display the dialog and retrieve its
    information much like it would do with a <a href="/~rhowell/DataStructures/redirect/file-dialogs">file
    dialog</a>:
<pre>
/// &lt;summary&gt;
/// Handles a Get New Information event.
/// &lt;/summary&gt;
/// &lt;param name="sender"&gt;&lt;/param&gt;
/// &lt;param name="e"&gt;&lt;/param&gt;
private void uxNew_Click(object sender, EventArgs e)
{
    if (uxInformation.ShowDialog() == DialogResult.OK)
    {
        uxName.Text = uxInformation.FullName;
        uxPhoneNumber.Text = uxInformation.PhoneNumber;
        uxSiblings.Text = uxInformation.Siblings.ToString();
    }
}
</pre>
<a href="Ksu.Cis300.CustomDialogExample.zip">This zip archive</a>
    contains the complete program described above.

<p></p>
<p>
</p>
<p>
</p>
<p></p>
</body>
</html>
