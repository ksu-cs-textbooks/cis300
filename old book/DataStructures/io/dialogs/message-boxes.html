<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Message Boxes</title>
<link href="/~rhowell/style.css" rel="STYLESHEET"/>
</head>
<body>
<h1><b>Message Box</b>es</h1>

The <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.messagebox(v=vs.110).aspx"><b>MessageBox</b></a>
      class (found in the <a href="http://msdn.microsoft.com/en-us/library/System.Windows.Forms(v=vs.110).aspx"><b>System.Windows.Forms</b></a>
      namespace) provides a simple mechanism for displaying a message
      and obtaining one of a few simple responses from the user.  The
      most common usage of a <b>MessageBox</b> is to call one of its
      various <b>Show</b> methods, each of which is <a href="/~rhowell/DataStructures/redirect/static-this"><b>static</b></a>.
      The 
      simplest <a href="http://msdn.microsoft.com/en-us/library/519bytz3(v=vs.110).aspx"><b>Show</b></a>
      method takes a <b>string</b> as its only parameter.  The method
      then displays this <b>string</b> in a modal dialog containing an
      "OK" button.  Thus, for example,
<pre>
MessageBox.Show("Hello world!");
</pre>
will display the following dialog:
<p>
<img alt="A picture of a window should appear here." src="simple-message-box.jpg"/>
</p>
Because the dialog is modal, it will block all other interaction with
    the program until the user closes it by clicking either the "OK"
    button or the "X" in the upper right.  Furthermore, the
    <b>Show</b> method will not return until that time.
<p>
Other <b>Show</b> methods allow greater customization of a
      <b>MessageBox</b>.  For example, one <a href="http://msdn.microsoft.com/en-us/library/20stz12s(v=vs.110).aspx"><b>Show</b></a>
      method takes as an additional parameter a second <b>string</b>
      giving a caption for the <b>MessageBox</b>.  Thus, the statment,
</p>
<pre>
MessageBox.Show("Hello world!", "Hello");
</pre>
will display the following modal dialog:
<p>
<img alt="A picture of a window should appear here." src="message-box-with-caption.jpg"/>
</p>
Other <b>Show</b> methods allow the buttons to be customized.  For
    example, one <a href="http://msdn.microsoft.com/en-us/library/0x49kd7z(v=vs.110).aspx"><b>Show</b></a>
    method takes, as its third parameter, an
    element from the <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.messageboxbuttons(v=vs.110).aspx"><b>MessageBoxButtons</b></a>
<a href="/~rhowell/DataStructures/redirect/enumerations">enumeration</a>.
    This <a href="/~rhowell/DataStructures/redirect/enumerations">enumeration</a>
    contains the following values:
<ul>
<li> <b>MessageBoxButtons.AbortRetryIgnore</b>:  Buttons labeled
	"Abort", "Retry", and "Ignore" are shown. </li>
<li> <b>MessageBoxButtons.OK</b>:  A single button labeled "OK" is
	shown. </li>
<li> <b>MessageBoxButtons.OKCancel</b>: Buttons labeled "OK" and
	"Cancel" are shown. </li>
<li> <b>MessageBoxButtons.RetryCancel</b>:  Buttons labeled "Retry"
	and "Cancel" are shown. </li>
<li> <b>MessageBoxButtons.YesNo</b>: Buttons labeled "Yes" and "No"
	are shown. </li>
<li> <b>MessageBoxButtons.YesNoCancel</b>:  Buttons labeled "Yes",
	"No", and "Cancel" are shown. </li>
</ul>
The values above containing the word, "Cancel", cause the "X" in the
    upper-right of the dialog to be enabled.  Clicking this button in
    these cases is equivalent to clicking the "Cancel" button.  The
    value, <b>MessageBoxButtons.OK</b>, also enables this "X" button,
    but in this case, clicking this button is equivalent to clicking
    the "OK" button.  Using a <b>Show</b> without a
    <b>MessageBoxButtons</b> parameter also gives this behavior.  For
    all other <b>MessageBoxButtons</b> values, this "X" button is
    disabled.
<p></p>
In order to provide appropriate functionality to each of the buttons,
    each <b>Show</b> 
    method returns a value of type <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.dialogresult(v=vs.110).aspx"><b>DialogResult</b></a>.
    This type is another <a href="/~rhowell/DataStructures/redirect/enumerations">enumeration</a>
    containing 
    the following values to indicate which button the user clicked:
<ul>
<li> <b>DialogResult.Abort</b></li>
<li> <b>DialogResult.Cancel</b></li>
<li> <b>DialogResult.Ignore</b></li>
<li> <b>DialogResult.No</b></li>
<li> <b>DialogResult.None</b> (this value won't be returned by any of
	the <b>Show</b> methods)</li>
<li> <b>DialogResult.OK</b></li>
<li> <b>DialogResult.Retry</b></li>
<li> <b>DialogResult.Yes</b></li>
</ul>
Suppose, for example, that we are writing a document formatter or some
    other application in which the user builds a document.  If the
    user attempts to exit the program when the document is unsaved, we
    would like to give an opportunity to save the document.  We can
    accomplish this with the following code:
<pre>
DialogResult result = MessageBox.Show("The file is not saved. Really quit?", 
    "Confirm Quit", MessageBoxButtons.YesNo);
if (result == DialogResult.Yes)
{
    Application.Exit();
}
</pre>
The first statement displays the following dialog:
<p>
<img alt="A picture of a window should appear here." src="message-box-with-buttons.jpg"/>
</p>
Again, because the dialog is modal, the <b>Show</b> method does not
    return until the user closes the dialog by clicking one of the two
    buttons (the "X" in the upper right is disabled).  When the user
    does this, the dialog closes, and the 
    <b>Show</b> method returns either <b>DialogResult.Yes</b> or
    <b>DialogResult.No</b> to indicate which button the user clicked.
    If the user clicked the "Yes" button, then the <b>if</b>-statement
    will cause the program to terminate.  Otherwise, the program will
    continue with whatever code follows (probably nothing more, as the
    program will need to await further user action).
<p>
We can also decorate a <b>MessageBox</b> with an icon that indicates
      what type of message it is.  This requires another <a href="http://msdn.microsoft.com/en-us/library/365dky5y(v=vs.110).aspx">
<b>Show</b></a> method having a fourth parameter of
      type <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.messageboxicon(v=vs.110).aspx"><b>MessageBoxIcon</b></a>.
      <b>MessageBoxIcon</b> is another enumeration.  Some of its
      values are:
</p>
<ul>
<li> <b>MessageBoxIcon.Error</b>: 
<br/>
<img alt="A picture of an error icon should appear here." src="error-icon.jpg"/>
</li>
<li> <b>MessageBoxIcon.Information</b>: 
<br/>
<img alt="A picture of an information icon should appear here." src="information-icon.jpg"/>
</li>
<li> <b>MessageBoxIcon.None</b> (no icon) </li>
<li> <b>MessageBoxIcon.Question</b> (MicrosoftÃ‚Â® recommends avoiding
	this, although they use it in Visual StudioÃ‚Â® 2013): 
<br/>
<img alt="A picture of a question icon should appear here." src="question-icon.jpg"/>
</li>
<li> <b>MessageBoxIcon.Warning</b>: 
<br/>
<img alt="A picture of a warning icon should appear here." src="warning-icon.jpg"/>
</li>
</ul>
This enumeration contains a few other values as well, but they
    currently are simply duplicate values for the above icons.  To add
    a warning icon to the above example, we could replace the first
    statement with:
<pre>
DialogResult result = MessageBox.Show("The file is not saved. Really quit?", 
    "Confirm Quit", MessageBoxButtons.YesNo, MessageBoxIcon.Warning);
</pre>
This will display the following dialog:
<p>
<img alt="A picture of a window should appear here." src="message-box-with-icon.jpg"/>
</p>
Notice that in the above example, the "Yes" button has the focus;
    i.e., pressing "Enter" has the same effect as clicking this
    button.  It is usually desirable to have the safest response as
    the default - in this case, the "No" button.  To achieve this, a
    <a href="http://msdn.microsoft.com/en-us/library/ctd56yay(v=vs.110).aspx"><b>Show</b></a>
    method having a
    fifth parameter, of type <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.messageboxdefaultbutton(v=vs.110).aspx"><b>MessageBoxDefaultButton</b></a>,
    is required.  <b>MessageBoxDefaultButton</b> is another
    enumeration having the following values to select an appropriate
    button to be the default:
<ul>
<li> <b>MessageBoxDefaultButton.Button1</b></li>
<li> <b>MessageBoxDefaultButton.Button2</b></li>
<li> <b>MessageBoxDefaultButton.Button3</b></li>
</ul>
Thus, the following statement:
<pre>
DialogResult result = MessageBox.Show("The file is not saved. Really quit?", 
    "Confirm Quit", MessageBoxButtons.YesNo, MessageBoxIcon.Warning,
    MessageBoxDefaultButton.Button2);
</pre>
produces a dialog similar to the one above, but having the "No" button
    as its default.
<p>
There are other <b>Show</b> methods that allow additional fine-tuning;
      however, the ones described here cover most of the
      functionality.  For details on other <b>Show</b> methods, see
      the <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.messagebox(v=vs.110).aspx">documentation
      for the <b>MessageBox</b> class</a>.
</p>
<p></p>
<p>
</p>
<p>
</p>
<p></p>
</body>
</html>
