<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>The foreach Statement</title>
<link href="/~rhowell/style.css" rel="STYLESHEET"/>
</head>
<body>
<h1>The foreach Statement</h1>

C# provides a <b>foreach</b> statement that is often useful for
    iterating through the elements of certain data structures.  A
    <b>foreach</b> can be used when all of the following conditions
    hold:
<ol>
<li> The data structure is a subtype of either <a href="http://msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx"><b>IEnumerable</b></a>
	  or <a href="http://msdn.microsoft.com/en-us/library/9eekhta0(v=vs.110).aspx"><b>IEnumerable&lt;T&gt;</b></a>
	  for some type <b>T</b>. </li>
<li> You do not need to know the locations in the data structure of
	  the individual elements. </li>
<li> You do not need to modify the data structure with this
	  loop. </li>
</ol>

Note that many of the data structures provided to you in CIS 300, as
    well as many that you are to write yourself for this class, are not
    subtypes of either of the types mentioned in 1 above.  Consequently, 
    we cannot use a <b>foreach</b> loop to iterate through any of
    these data structures.  However, most of the data structures
    provided in the .NET Framework, as well as all arrays, are subtypes
    of one of these types. 
<p>
For example, the <b>string</b> class is a subtype of both
      <b>IEnumerable</b> and <b>IEnumerable&lt;char&gt;</b>.  To see
      that this is the case, look in <a href="http://msdn.microsoft.com/en-us/library/system.string(v=vs.110).aspx">the
      documentation for the <b>string</b> class</a>.  In the "Syntax"
      section, we see all of the supertypes of <b>string</b> (except
      <b>object</b>, which is a supertype of every type) listed after
      the colon (':').  We can therefore iterate through the elements
      (i.e., the characters) of a <b>string</b> using a <b>foreach</b>
      statement, provided we don't need to know the location of each
      character in the <b>string</b> (because a <b>string</b> is
      immutable, we can't change its contents).
</p>
Suppose, for example, that we want to find out how many times the
    letter 'i' occurs in a <b>string</b> <tt>s</tt>.  Because we don't
    need to know the locations of these occurrences, we can iterate
    through the characters with a <b>foreach</b> loop, as follows:
<pre>
int count = 0;
foreach (char c in s)
{
    if (c == 'i')
    {
        count++;
    }
}
</pre>
The <b>foreach</b> statement requires three pieces of information:
<ul>
<li> The type of the elements in the data structure (<b>char</b> in
	the above example). </li>
<li> The name of a new variable (<tt>c</tt> in the above example).
	The type of this variable will be the type of the elements in
	the data structure (i.e., <b>char</b> in the above example).
	It will take on the values of the 
	elements as the loop iterates. </li>
<li> Following the keyword <b>in</b>, the data structure being
	traversed (<tt>s</tt> in the above example). </li>
</ul>
The loop then iterates once for each element in the data structure
    (unless a statement like <b>return</b> or <b>break</b> causes it
    to terminate prematurely).  On each iteration, the variable
    defined in the <b>foreach</b> statement stores one of the elements
    in the data structure.  Thus, in the above example, <tt>c</tt>
    takes the value of a different character in <tt>s</tt> on each
    iteration.  Note, however, 
    that we have no access to the location containing <tt>c</tt> on
    any particular iteration - this is why we don't use a
    <b>foreach</b> loop when we need to know the locations of the
    elements.  Because <tt>c</tt> takes on the value of each character
    in <tt>s</tt>, we are able to count how many of them equal 'i'.
<p>
Occasionally, it may not be obvious what type to use for the
      <b>foreach</b> loop variable.  In such cases, if the data
      structure is a subtype of <b>IEnumerable&lt;T&gt;</b>, then the
      type should be whatever type is used for <b>T</b>.  Otherwise, it
      is safe to use 
      <b>object</b>.  Note, however, that if the data structure is
      not a subtype of <b>IEnumerable&lt;T&gt;</b>, but you know that
      the elements are some specific subtype of <b>object</b>, you can
      use that type for the loop variable - the type will not be
      checked until the code is executed.  For example, <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox(v=vs.110).aspx"><b>ListBox</b></a>
      is a class that implements a GUI control displaying a list of
      elements.  The 
      elements in the <b>ListBox</b> are accessed via its <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.items(v=vs.110).aspx"><b>Items</b></a>
      property, which gets a data structure of type <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.objectcollection(v=vs.110).aspx"><b>ListBox.ObjectCollection</b></a>.
      Any
      <b>object</b> can be added to this data structure, but typically
      we just add <b>string</b>s.  <b>ListBox.ObjectCollection</b> is
      a subtype of <b>IEnumerable</b>; however, it is permissible to
      set up a <b>foreach</b> loop as follows:
</p>
<pre>
foreach (string s in uxList.Items)
{
    . . .
}
</pre>
where <tt>uxList</tt> is a <b>ListBox</b> variable.  As long as all of
    the elements in <b>uxList.Items</b> are <b>string</b>s, no
    exception will be thrown.
<p>
While the <b>foreach</b> statement provides a clean way to iterate
      through a data structure, it is important to keep in mind its
      limitations.  First, it can't even be used on data structures
      that aren't subtypes of <b>IEnumerable</b> or
      <b>IEnumerable&lt;T&gt;</b>.  Second, there are many cases,
      especially when iterating through arrays, where the processing
      we need to do on the elements depends on the locations of the
      elements.  For example, consider the problem of determining
      whether two arrays contain the same elements in the same order.
      For each element of one array, we need to know if the element
      <i>at the same location</i> in the other array is the same.
      Because the locations are important, a <b>foreach</b> loop isn't
      appropriate - we should use a <b>for</b> loop instead.  Finally,
      a <b>foreach</b> should never be used to modify a data
      structure, as this causes unpredictable results.
</p>
Even when a <b>foreach</b> would work, it is not always
    the best choice.  For example, in order to determine whether a
    data structure contains a given element, we could iterate through
    the structure with a <b>foreach</b> loop and compare each element
    to the given element.  While this would work, most data structures
    provide methods for determining whether they contain a given
    element.  These methods are often far more efficient than using a
    <b>foreach</b> loop.
<p></p>
<p>
</p>
<p></p>
</body>
</html>
