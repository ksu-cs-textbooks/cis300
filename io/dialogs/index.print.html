<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=robots content="noindex, nofollow, noarchive, noimageindex"><meta name=description content="Dialogs Dialogs are windows displayed by a program for the purpose of exchanging specific information with the user. There are two kinds of dialogs:
Modal dialogs block all other interaction with the program until the dialog is closed. Non-modal dialogs allow the user to interact with the program in other ways while the dialog is open. We will examine three classes provided by Microsoft® .NET 6, each of which implements a modal dialog."><meta name=author content="Rod Howell and Josh Weese"><meta name=twitter:card content="summary"><meta name=twitter:title content="Dialogs :: Data Structures in C#"><meta name=twitter:description content="Dialogs Dialogs are windows displayed by a program for the purpose of exchanging specific information with the user. There are two kinds of dialogs:
Modal dialogs block all other interaction with the program until the dialog is closed. Non-modal dialogs allow the user to interact with the program in other ways while the dialog is open. We will examine three classes provided by Microsoft® .NET 6, each of which implements a modal dialog."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis300/io/dialogs/"><meta property="og:site_name" content="Data Structures in C#"><meta property="og:title" content="Dialogs :: Data Structures in C#"><meta property="og:description" content="Dialogs Dialogs are windows displayed by a program for the purpose of exchanging specific information with the user. There are two kinds of dialogs:
Modal dialogs block all other interaction with the program until the dialog is closed. Non-modal dialogs allow the user to interact with the program in other ways while the dialog is open. We will examine three classes provided by Microsoft® .NET 6, each of which implements a modal dialog."><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta itemprop=name content="Dialogs :: Data Structures in C#"><meta itemprop=description content="Dialogs Dialogs are windows displayed by a program for the purpose of exchanging specific information with the user. There are two kinds of dialogs:
Modal dialogs block all other interaction with the program until the dialog is closed. Non-modal dialogs allow the user to interact with the program in other ways while the dialog is open. We will examine three classes provided by Microsoft® .NET 6, each of which implements a modal dialog."><meta itemprop=dateModified content="2023-05-30T14:31:54-05:00"><meta itemprop=wordCount content="104"><title>Dialogs :: Data Structures in C#</title>
<link href=/cis300/css/fontawesome-all.min.css?1723840626 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis300/css/fontawesome-all.min.css?1723840626 rel=stylesheet></noscript><link href=/cis300/css/nucleus.css?1723840626 rel=stylesheet><link href=/cis300/css/auto-complete.css?1723840626 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis300/css/auto-complete.css?1723840626 rel=stylesheet></noscript><link href=/cis300/css/perfect-scrollbar.min.css?1723840626 rel=stylesheet><link href=/cis300/css/fonts.css?1723840626 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis300/css/fonts.css?1723840626 rel=stylesheet></noscript><link href=/cis300/css/theme.css?1723840626 rel=stylesheet><link href=/cis300/css/theme-auto.css?1723840626 rel=stylesheet id=R-variant-style><link href=/cis300/css/chroma-auto.css?1723840626 rel=stylesheet id=R-variant-chroma-style><link href=/cis300/css/variant.css?1723840626 rel=stylesheet><link href=/cis300/css/print.css?1723840626 rel=stylesheet media=print><link href=/cis300/css/format-print.css?1723840626 rel=stylesheet><script src=/cis300/js/variant.js?1723840626></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis300",window.index_js_url="/cis300/index.search.js",window.variants&&variants.init(["auto","light-theme","dark-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis300/css/custom.css?1723840626 rel=stylesheet></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/cis300/io/dialogs/><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/cis300/io/><span itemprop=name>Input/Output</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Dialogs</span><meta itemprop=position content="2"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis300/io/ title="Input/Output (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis300/io/dialogs/message-boxes/ title="MessageBoxes (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><div hidden><h1 id=dialogs>Dialogs</h1></div><h2 id=dialogs>Dialogs</h2><p>Dialogs are windows displayed by a program for the purpose of exchanging specific information with the user. There are two kinds of dialogs:</p><ul><li><em>Modal</em> dialogs block all other interaction with the program until the dialog is closed.</li><li><em>Non-modal</em> dialogs allow the user to interact with the program in other ways while the dialog is open.</li></ul><p>We will examine three classes provided by Microsoft® .NET 6, each of which implements a modal dialog. .NET provides various other classes, such as <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.folderbrowserdialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>FolderBrowserDialog</strong></a>, <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.fontdialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>FontDialog</strong></a>, and <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.colordialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>ColorDialog</strong></a>, that also implement specific kinds of dialogs. We conclude by discussing how custom dialogs may be built using Visual Studio®.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Dialogs</h1><article class=default><header class=headline></header><div hidden><h1 id=messageboxes>MessageBoxes</h1></div><h2 id=message-boxes><strong>Message Box</strong>es</h2><p>The <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox?view=windowsdesktop-6.0" rel=external target=_blank><strong>MessageBox</strong></a> class (found in the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms?view=windowsdesktop-6.0" rel=external target=_blank><strong>System.Windows.Forms</strong></a> namespace) provides a simple mechanism for displaying a message and obtaining one of a few simple responses from the user. The most common usage of a <strong>MessageBox</strong> is to call one of its various <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox.show?view=windowsdesktop-6.0" rel=external target=_blank><strong>Show</strong></a> methods, each of which is <a href=/cis300/appendix/syntax/static-this/><strong>static</strong></a>. The simplest <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox.show?view=windowsdesktop-6.0#system-windows-forms-messagebox-show(system-string)" rel=external target=_blank><strong>Show</strong></a> method takes a <strong>string</strong> as its only parameter. The method then displays this <strong>string</strong> in a modal dialog containing an &ldquo;OK&rdquo; button. Thus, for example,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>MessageBox</span><span class=p>.</span><span class=n>Show</span><span class=p>(</span><span class=s>&#34;Hello world!&#34;</span><span class=p>);</span></span></span></code></pre></div><p>will display the following dialog:</p><img src=/cis300/io/dialogs/message-boxes/simple-message-box.png alt="A MessageBox." style=zoom:67%><p>Because the dialog is modal, it will block all other interaction with the program until the user closes it by clicking either the &ldquo;OK&rdquo; button or the &ldquo;X&rdquo; in the upper right. Furthermore, the <strong>Show</strong> method will not return until that time.</p><p>Other <strong>Show</strong> methods allow greater customization of a <strong>MessageBox</strong>. For example, one <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox.show?view=windowsdesktop-6.0#system-windows-forms-messagebox-show(system-string-system-string)" rel=external target=_blank><strong>Show</strong></a> method takes as an additional parameter a second <strong>string</strong> giving a caption for the <strong>MessageBox</strong>. Thus, the statement,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>MessageBox</span><span class=p>.</span><span class=n>Show</span><span class=p>(</span><span class=s>&#34;Hello world!&#34;</span><span class=p>,</span> <span class=s>&#34;Hello&#34;</span><span class=p>);</span></span></span></code></pre></div><p>will display the following modal dialog:</p><img src=/cis300/io/dialogs/message-boxes/message-box-with-caption.png alt="A MessageBox with a caption." style=zoom:67%><p>Other <strong>Show</strong> methods allow the buttons to be customized. For example, one <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox.show?view=windowsdesktop-6.0#system-windows-forms-messagebox-show(system-string-system-string-system-windows-forms-messageboxbuttons)" rel=external target=_blank><strong>Show</strong></a> method takes, as its third parameter, an element from the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messageboxbuttons?view=windowsdesktop-6.0" rel=external target=_blank><strong>MessageBoxButtons</strong></a> <a href=/cis300/appendix/syntax/enumerations/>enumeration</a>. This <a href=/cis300/appendix/syntax/enumerations/>enumeration</a> contains the following values:</p><ul><li><strong>MessageBoxButtons.AbortRetryIgnore</strong>: Buttons labeled &ldquo;Abort&rdquo;, &ldquo;Retry&rdquo;, and &ldquo;Ignore&rdquo; are shown.</li><li><strong>MessageBoxButtons.CancelTryContinue</strong>: Buttons labeled &ldquo;Cancel&rdquo;, &ldquo;Try Again&rdquo;, and &ldquo;Continue&rdquo; are shown.</li><li><strong>MessageBoxButtons.OK</strong>: A single button labeled &ldquo;OK&rdquo; is shown.</li><li><strong>MessageBoxButtons.OKCancel</strong>: Buttons labeled &ldquo;OK&rdquo; and &ldquo;Cancel&rdquo; are shown.</li><li><strong>MessageBoxButtons.RetryCancel</strong>: Buttons labeled &ldquo;Retry&rdquo; and &ldquo;Cancel&rdquo; are shown.</li><li><strong>MessageBoxButtons.YesNo</strong>: Buttons labeled &ldquo;Yes&rdquo; and &ldquo;No&rdquo; are shown.</li><li><strong>MessageBoxButtons.YesNoCancel</strong>: Buttons labeled &ldquo;Yes&rdquo;, &ldquo;No&rdquo;, and &ldquo;Cancel&rdquo; are shown.</li></ul><p>The values above containing the word, &ldquo;Cancel&rdquo;, cause the &ldquo;X&rdquo; in the upper-right of the dialog to be enabled. Clicking this button in these cases is equivalent to clicking the &ldquo;Cancel&rdquo; button. The value, <strong>MessageBoxButtons.OK</strong>, also enables this &ldquo;X&rdquo; button, but in this case, clicking this button is equivalent to clicking the &ldquo;OK&rdquo; button. Using a <strong>Show</strong> without a <strong>MessageBoxButtons</strong> parameter also gives this behavior. For all other <strong>MessageBoxButtons</strong> values, this &ldquo;X&rdquo; button is disabled.</p><p>In order to provide appropriate functionality to each of the buttons, each <strong>Show</strong> method returns a value of type <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.dialogresult?view=windowsdesktop-6.0" rel=external target=_blank><strong>DialogResult</strong></a>. This type is another enumeration containing the following values to indicate which button the user clicked:</p><ul><li><strong>DialogResult.Abort</strong></li><li><strong>DialogResult.Cancel</strong></li><li><strong>DialogResult.Continue</strong></li><li><strong>DialogResult.Ignore</strong></li><li><strong>DialogResult.No</strong></li><li><strong>DialogResult.None</strong> (this value won&rsquo;t be returned by any of the <strong>Show</strong> methods)</li><li><strong>DialogResult.OK</strong></li><li><strong>DialogResult.Retry</strong></li><li><strong>DialogResult.TryAgain</strong></li><li><strong>DialogResult.Yes</strong></li></ul><p>Suppose, for example, that we are writing a document formatter or some other application in which the user builds a document. If the user attempts to exit the program when the document is unsaved, we would like to give an opportunity to save the document. We can accomplish this with the following code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>DialogResult</span> <span class=n>result</span> <span class=p>=</span> <span class=n>MessageBox</span><span class=p>.</span><span class=n>Show</span><span class=p>(</span><span class=s>&#34;The file is not saved. Really quit?&#34;</span><span class=p>,</span> <span class=s>&#34;Confirm Quit&#34;</span><span class=p>,</span> <span class=n>MessageBoxButtons</span><span class=p>.</span><span class=n>YesNo</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>result</span> <span class=p>==</span> <span class=n>DialogResult</span><span class=p>.</span><span class=n>Yes</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Application</span><span class=p>.</span><span class=n>Exit</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>The first statement displays the following dialog:</p><img src=/cis300/io/dialogs/message-boxes/message-box-with-buttons.png alt="A MessageBox with Yes and No buttons" style=zoom:67%><p>Again, because the dialog is modal, the <strong>Show</strong> method does not return until the user closes the dialog by clicking one of the two buttons (the &ldquo;X&rdquo; in the upper right is disabled). When the user does this, the dialog closes, and the <strong>Show</strong> method returns either <strong>DialogResult.Yes</strong> or <strong>DialogResult.No</strong> to indicate which button the user clicked. If the user clicked the &ldquo;Yes&rdquo; button, then the <strong>if</strong>-statement will cause the program to terminate. Otherwise, the program will continue with whatever code follows (probably nothing more, as the program will need to await further user action).</p><p>We can also decorate a <strong>MessageBox</strong> with an icon that indicates what type of message it is. This requires another <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox.show?view=windowsdesktop-6.0#system-windows-forms-messagebox-show(system-string-system-string-system-windows-forms-messageboxbuttons-system-windows-forms-messageboxicon)" rel=external target=_blank><strong>Show</strong></a> method having a fourth parameter of type <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messageboxicon?view=windowsdesktop-6.0" rel=external target=_blank><strong>MessageBoxIcon</strong></a>. <strong>MessageBoxIcon</strong> is another enumeration. Some of its values are:</p><ul><li><strong>MessageBoxIcon.Error</strong>: <a href=#R-image-12285aa08a7e0e184b3aadb0b160a54b class=lightbox-link><img alt="A picture of an error icon should appear here." class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis300/io/dialogs/message-boxes/messagebox-error.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-12285aa08a7e0e184b3aadb0b160a54b><img alt="A picture of an error icon should appear here." class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis300/io/dialogs/message-boxes/messagebox-error.png></a></li><li><strong>MessageBoxIcon.Information</strong>: <a href=#R-image-7a280a95b014720450e939a27cfe82b0 class=lightbox-link><img alt="A picture of an information icon should appear here." class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis300/io/dialogs/message-boxes/messagebox-information.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a280a95b014720450e939a27cfe82b0><img alt="A picture of an information icon should appear here." class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis300/io/dialogs/message-boxes/messagebox-information.png></a></li><li><strong>MessageBoxIcon.None</strong> (no icon)</li><li><strong>MessageBoxIcon.Warning</strong>: <a href=#R-image-ebdf5988e31fd3ad1f087d1f65c0f2d1 class=lightbox-link><img alt="A picture of a warning icon should appear here." class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis300/io/dialogs/message-boxes/messagebox-exclamation.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ebdf5988e31fd3ad1f087d1f65c0f2d1><img alt="A picture of a warning icon should appear here." class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis300/io/dialogs/message-boxes/messagebox-exclamation.png></a></li></ul><p>This enumeration contains a few other values as well, but they currently are simply duplicate values for the above icons or values that Microsoft recommends against using. To add a warning icon to the above example, we could replace the first statement with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>DialogResult</span> <span class=n>result</span> <span class=p>=</span> <span class=n>MessageBox</span><span class=p>.</span><span class=n>Show</span><span class=p>(</span><span class=s>&#34;The file is not saved. Really quit?&#34;</span><span class=p>,</span> <span class=s>&#34;Confirm Quit&#34;</span><span class=p>,</span> <span class=n>MessageBoxButtons</span><span class=p>.</span><span class=n>YesNo</span><span class=p>,</span> <span class=n>MessageBoxIcon</span><span class=p>.</span><span class=n>Warning</span><span class=p>);</span></span></span></code></pre></div><p>This will display the following dialog:</p><img src=/cis300/io/dialogs/message-boxes/message-box-with-icon.png alt="A MessageBox with an icon." style=zoom:67%><p>Notice that in the above example, the &ldquo;Yes&rdquo; button has the focus; i.e., pressing &ldquo;Enter&rdquo; has the same effect as clicking this button. It is usually desirable to have the safest response as the default - in this case, the &ldquo;No&rdquo; button. To achieve this, a <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox.show?view=windowsdesktop-6.0#system-windows-forms-messagebox-show(system-string-system-string-system-windows-forms-messageboxbuttons-system-windows-forms-messageboxicon-system-windows-forms-messageboxdefaultbutton)" rel=external target=_blank><strong>Show</strong></a> method having a fifth parameter, of type <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messageboxdefaultbutton?view=windowsdesktop-6.0" rel=external target=_blank><strong>MessageBoxDefaultButton</strong></a>, is required. <strong>MessageBoxDefaultButton</strong> is another enumeration having the following values to select an appropriate button to be the default:</p><ul><li><strong>MessageBoxDefaultButton.Button1</strong></li><li><strong>MessageBoxDefaultButton.Button2</strong></li><li><strong>MessageBoxDefaultButton.Button3</strong></li><li><strong>MessageBoxDefaultButton.Button4</strong></li></ul><p>Thus, the following statement:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>DialogResult</span> <span class=n>result</span> <span class=p>=</span> <span class=n>MessageBox</span><span class=p>.</span><span class=n>Show</span><span class=p>(</span><span class=s>&#34;The file is not saved. Really quit?&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s>&#34;Confirm Quit&#34;</span><span class=p>,</span> <span class=n>MessageBoxButtons</span><span class=p>.</span><span class=n>YesNo</span><span class=p>,</span> <span class=n>MessageBoxIcon</span><span class=p>.</span><span class=n>Warning</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>MessageBoxDefaultButton</span><span class=p>.</span><span class=n>Button2</span><span class=p>);</span></span></span></code></pre></div><p>produces a dialog similar to the one above, but having the &ldquo;No&rdquo; button as its default.</p><p>There are other <strong>Show</strong> methods that allow additional fine-tuning; however, the ones described here cover most of the functionality. For details on other <strong>Show</strong> methods, see the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox?view=windowsdesktop-6.0" rel=external target=_blank>documentation for the <strong>MessageBox</strong> class</a>.</p><footer class=footline></footer></article><article class=default><header class=headline></header><div hidden><h1 id=file-dialogs>File Dialogs</h1></div><h2 id=file-dialogs>File Dialogs</h2><p>The <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms?view=windowsdesktop-6.0" rel=external target=_blank><strong>System.Windows.Forms</strong></a> namespace contains two other classes that implement modal dialogs for obtaining file names from the user. These classes are <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.openfiledialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>OpenFileDialog</strong></a>, which is designed to obtain the name of a file to read, and <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.savefiledialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>SaveFileDialog</strong></a>, which is designed to obtain the name of a file to write. Because we often need to obtain the name of a file prior to doing file I/O, it is appropriate to consider these classes now.</p><p>Although these dialogs are visually separate from the window from which they are opened, it is possible (and usually desirable) to add instances of these classes to a form from <a href=/cis300/appendix/vs/design-window/>the Design window</a>. Both can be found in the &ldquo;Dialogs&rdquo; section of the Toolbox. They can be added to the form simply by double-clicking on their names. They will not appear on the form itself, but in a separate area of the Design window. Their properties can then be modified in the same way as any other control. We will discuss some of these properties a bit later in what follows.</p><p>Each of these classes has a method called <strong>ShowDialog</strong> that takes no parameters. For example, if we call the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.commondialog.showdialog?view=windowsdesktop-6.0#system-windows-forms-commondialog-showdialog" rel=external target=_blank><strong>ShowDialog</strong></a> method of an <strong>OpenFileDialog</strong>, a dialog resembling the following will be opened:</p><img src=/cis300/io/dialogs/file-dialogs/open-file-dialog.png alt="An OpenFileDialog." style=zoom:67%><p>Similarly, calling the <strong>ShowDialog</strong> method of a <strong>SaveFileDialog</strong> opens a dialog resembling the following:</p><img src=/cis300/io/dialogs/file-dialogs/save-file-dialog.png alt="A SaveFileDialog." style=zoom:67%><p>Because these dialogs are modal, the method call will not return until the user closes the dialog. It will then return a <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.dialogresult?view=windowsdesktop-6.0" rel=external target=_blank><strong>DialogResult</strong></a> indicating how the user closed the form - either <strong>DialogResult.OK</strong> or <strong>DialogResult.Cancel</strong> (see <a href=/cis300/io/dialogs/message-boxes/>the previous section</a> for more information on the <strong>DialogResult</strong> type). Therefore, if <code>uxFileDialog</code> is a variable referring to a file dialog, we typically use the following code template to display it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>uxFileDialog</span><span class=p>.</span><span class=n>ShowDialog</span><span class=p>()</span> <span class=p>==</span> <span class=n>DialogResult</span><span class=p>.</span><span class=n>OK</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Process the file</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Thus, if the user selects a file, we process it; otherwise, we do nothing. In some cases, we might include an <strong>else</strong> containing code that needs to be executed if the user closes the dialog without selecting a file.</p><p>Processing a file will be discussed in the three sections that follow. However, one thing we will certainly want to do prior to processing the file is to obtain the file name that the user selected (after all, this is the reason we display a file dialog). We can obtain this file name via the dialog&rsquo;s <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.filename?view=windowsdesktop-6.0#system-windows-forms-filedialog-filename" rel=external target=_blank><strong>FileName</strong></a> <a href=/cis300/appendix/syntax/properties/>property</a>; for example,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>string</span> <span class=n>fileName</span> <span class=p>=</span> <span class=n>uxFileDialog</span><span class=p>.</span><span class=n>FileName</span><span class=p>;</span></span></span></code></pre></div><p>Note that this and other properties are accessible for initialization purposes through a file dialog&rsquo;s Properties window in the Designer. This is useful for an <strong>OpenFileDialog</strong>&rsquo;s <strong>FileName</strong> property, as the default supplied by Visual Studio® is rather odd. Other properties that we might want to initialize here (in addition to <strong>(Name)</strong>, the name of the variable referring to the dialog) include:</p><ul><li><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.title?view=windowsdesktop-6.0" rel=external target=_blank><strong>Title</strong></a>, the title of the dialog (by default, &ldquo;Open&rdquo; for an <strong>OpenFileDialog</strong> or &ldquo;Save As&rdquo; for a <strong>SaveFileDialog</strong>).</p></li><li><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.filter?view=windowsdesktop-6.0" rel=external target=_blank><strong>Filter</strong></a>, a <em>filter string</em>, which controls what file types will be displayed. An example of a filter string is: <code>C# files|*.cs|All files|*.*</code>. A filter string consists of an even number of components separated by vertical bars ("|"). Thus, the above filter string consists of four components. These components are grouped into pairs. The first component of each pair gives the string that will be displayed in the dialog to describe what files are displayed. The second component of each pair describes a pattern of file names to be displayed when the first component of that pair is shown. Use an asterisk ("*") in a pattern to denote any sequence of characters. The &ldquo;.&rdquo; in a pattern ending in &ldquo;.*&rdquo; does not need to be matched - a file without an extension will be listed if it matches the pattern to the left of the &ldquo;.&rdquo;. Multiple patterns, separated by semicolons (";"), may be listed in one component. Thus, the above filter string describes two filters that the user may choose from. The first filter is labeled, &ldquo;C# files&rdquo;, and lists all files ending in &ldquo;.cs&rdquo;. The second filter is labeled &ldquo;All files&rdquo;, and lists all files.</p></li><li><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.filterindex?view=windowsdesktop-6.0" rel=external target=_blank><strong>FilterIndex</strong></a> indicates which pair in the filter string is currently being used. Note that the first pair has an index of 1, not 0.</p></li><li><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.addextension?view=windowsdesktop-6.0" rel=external target=_blank><strong>AddExtension</strong></a> and <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.defaultext?view=windowsdesktop-6.0" rel=external target=_blank><strong>DefaultExt</strong></a> control the dialog&rsquo;s behavior when the user types in a file name without an extension. When this happens, if a filter with a unique extension is chosen, that extension will be appended, regardless of the values of these two properties. Otherwise, if <strong>AddExtension</strong> is <strong>True</strong>, the value of <strong>DefaultExt</strong> will be appended, following a &ldquo;.&rdquo;.</p></li></ul><p>Other properties allow further customization of file dialogs. For more
details, see the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.openfiledialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>OpenFileDialog</strong></a> and <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.savefiledialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>SaveFileDialog</strong></a> documentation.</p><footer class=footline></footer></article><article class=default><header class=headline></header><div hidden><h1 id=custom-dialogs>Custom Dialogs</h1></div><h2 id=custom-dialogs>Custom Dialogs</h2><p>While the dialogs provided by the .NET Framework are useful in a variety of applications, there are times when we need to be able to design our own special-purpose dialog to obtain specific information from the user. This section outlines how Visual Studio® can be used to build such a dialog.</p><p>Let&rsquo;s begin by considering a simple example. Suppose we are building an application that needs a dialog to obtain from the user the following pieces of information:</p><ul><li>a name;</li><li>a phone number; and</li><li>a number of siblings.</li></ul><p>In order to keep the example simple, the program will simply display this information in its main window. Thus, the main window looks like this:</p><img src=/cis300/io/dialogs/custom/custom-dialog-main.jpg alt="A GUI displaying a person's information." style=zoom:67%><p>Clicking the &ldquo;Get New Information&rdquo; button will open our custom dialog, which will look like this:</p><img src=/cis300/io/dialogs/custom/custom-dialog.jpg alt="A custom dialog." style=zoom:67%><p>After the user enters the information, clicking &ldquo;OK&rdquo; will cause the information entered to be displayed in the main window. If the user clicks &ldquo;Cancel&rdquo;, the main window will be unchanged.</p><p>After building the main form in Visual Studio&rsquo;s Design Window, we can build the dialog by creating another form. To do this, in the Solution Explorer, right-click on the project name and select &ldquo;Add->Form (Windows Forms)&mldr;&rdquo;. This will open a dialog for adding a new item, where the type of item is pre-selected to be a Windows Form. You will need to supply a name for the form. This name will serve as both a file name for a source file and the name of a class defined within this file. For example, we could choose the name, &ldquo;InformationDialog.cs&rdquo;, and the class will be named <strong>InformationDialog</strong>. Clicking the &ldquo;Add&rdquo; button will then open a new Design Window containing a form.</p><p>We can then use the Design Window to build this form as we would build any other form. In addition, the <strong>Button</strong> class has a <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.button.dialogresult?view=windowsdesktop-6.0#system-windows-forms-button-dialogresult" rel=external target=_blank><strong>DialogResult</strong></a> property that governs certain behavior when buttons are used within a dialog. This property is of type <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.dialogresult?view=windowsdesktop-6.0" rel=external target=_blank><strong>DialogResult</strong></a>. Setting it to a value other than <strong>None</strong> will cause the button to do the following when clicked, provided the form is displayed as a <a href=/cis300/io/dialogs/>modal dialog</a>:</p><ul><li>Close the form.</li><li>Return the value of the <strong>DialogResult</strong> property.</li></ul><p>Thus, we should set the &ldquo;OK&rdquo; button&rsquo;s <strong>DialogResult</strong> property to <strong>OK</strong> and the &ldquo;Cancel&rdquo; button&rsquo;s <strong>DialogResult</strong> property to <strong>Cancel</strong>. Once we have done this, there is no need to define any event handlers for these buttons.</p><p>Furthermore, the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.form?view=windowsdesktop-6.0" rel=external target=_blank><strong>Form</strong></a> itself has two properties that can be set to provide shortcuts for these buttons. The <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.form.acceptbutton?view=windowsdesktop-6.0#system-windows-forms-form-acceptbutton" rel=external target=_blank><strong>AcceptButton</strong></a> property, of type <strong>IButtonControl</strong> (a super-type of <strong>Button</strong>), can be used to cause the &ldquo;Enter&rdquo; key to activate a button on the form, as if that button had been clicked. Thus, we could set this property to the &ldquo;OK&rdquo; button. Similarly, the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.form.cancelbutton?view=windowsdesktop-6.0#system-windows-forms-form-cancelbutton" rel=external target=_blank><strong>CancelButton</strong></a> property (also of type <strong>IButtonControl</strong>) can be used to cause the &ldquo;Esc&rdquo; key to activate a button on the form. We could therefore set this property to the &ldquo;Cancel&rdquo; button.</p><p>While we don&rsquo;t need any event handlers for this dialog, we still need to provide code to allow the class for the main window to access the values provided by the user. This can be accomplished with three <strong>public</strong> <a href=/cis300/appendix/syntax/properties/>properties</a>, one for each of the three pieces of information the user can provide:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Gets the name.  (There is already a Name property inherited from</span>
</span></span><span class=line><span class=cl><span class=cs>/// the Form class, so we will use FullName.)</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>string</span> <span class=n>FullName</span> <span class=p>=&gt;</span> <span class=n>uxName</span><span class=p>.</span><span class=n>Text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Gets the phone number.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>string</span> <span class=n>PhoneNumber</span> <span class=p>=&gt;</span> <span class=n>uxPhoneNumber</span><span class=p>.</span><span class=n>Text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Gets the number of siblings.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>int</span> <span class=n>Siblings</span> <span class=p>=&gt;</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>uxSiblings</span><span class=p>.</span><span class=n>Value</span><span class=p>;</span></span></span></code></pre></div><p>In order for the main window to be able to display this dialog, it needs to construct an instance of it. We can add to its class definition a <strong>private</strong> field initialized to such an instance:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// The dialog for obtaining information from the user.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=n>InformationDialog</span> <span class=n>_information</span> <span class=p>=</span> <span class=k>new</span><span class=p>();</span></span></span></code></pre></div><p>Finally, we need an event handler for the &ldquo;Get New Information&rdquo; button. This event handler needs to display the <strong>InformationDialog</strong> as a modal dialog, and if the user closes it with the &ldquo;OK&rdquo; button, to copy the information provided by the user to the main window. A <strong>Form</strong> provides two methods for displaying it as a dialog:</p><ul><li><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.control.show?view=windowsdesktop-6.0#system-windows-forms-control-show" rel=external target=_blank><strong>Show</strong></a> displays the <strong>Form</strong> as a <a href=/cis300/io/dialogs/>non-modal dialog</a>. It takes no parameters and returns nothing.</li><li><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.form.showdialog?view=windowsdesktop-6.0#system-windows-forms-form-showdialog" rel=external target=_blank><strong>ShowDialog</strong></a> displays the <strong>Form</strong> as a <a href=/cis300/io/dialogs/>modal dialog</a>. It takes no parameters and returns a <strong>DialogResult</strong> indicating how the user closed the dialog.</li></ul><p>Thus, the event handler can display the dialog and retrieve its information much like it would do with a <a href=/cis300/io/dialogs/file-dialogs/>file dialog</a>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Handles a Click event on the &#34;Get New Information&#34; button.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;sender&#34;&gt;The object signaling the event.&lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;e&#34;&gt;Information on the event.&lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=k>void</span> <span class=n>NewClick</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>EventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>_information</span><span class=p>.</span><span class=n>ShowDialog</span><span class=p>()</span> <span class=p>==</span> <span class=n>DialogResult</span><span class=p>.</span><span class=n>OK</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>uxName</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=n>_information</span><span class=p>.</span><span class=n>FullName</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>uxPhoneNumber</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=n>_information</span><span class=p>.</span><span class=n>PhoneNumber</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>uxSiblings</span><span class=p>.</span><span class=n>Text</span> <span class=p>=</span> <span class=n>_information</span><span class=p>.</span><span class=n>Siblings</span><span class=p>.</span><span class=n>ToString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p><a href=https://classroom.github.com/a/1a_tmRBS rel=external target=_blank>This git repository</a> contains the complete program described above.</p><footer class=footline></footer></article></section></div></main><div class=git-footer><p class=theme-version-footer>6.0.0</p><p>Last modified by:
<i class='fas fa-user'></i> Rod Howell
<i class='fas fa-calendar'></i> <a href=https://github.com/ksu-cs-textbooks/cis300/commit/7e8495e442abacbbeb0fa0ccb726d22ed33a2f15>May 30, 2023</a></p></div></div><script src=/cis300/js/clipboard.min.js?1723840626 defer></script><script src=/cis300/js/perfect-scrollbar.min.js?1723840626 defer></script><script src=/cis300/js/theme.js?1723840626 defer></script></body></html>