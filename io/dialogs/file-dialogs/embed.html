<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=robots content="noindex, nofollow, noarchive, noimageindex"><meta name=description content="File Dialogs The System.Windows.Forms namespace contains two other classes that implement modal dialogs for obtaining file names from the user. These classes are OpenFileDialog, which is designed to obtain the name of a file to read, and SaveFileDialog, which is designed to obtain the name of a file to write. Because we often need to obtain the name of a file prior to doing file I/O, it is appropriate to consider these classes now."><meta name=author content="Rod Howell and Josh Weese"><meta name=twitter:card content="summary"><meta name=twitter:title content="File Dialogs :: Data Structures in C#"><meta name=twitter:description content="File Dialogs The System.Windows.Forms namespace contains two other classes that implement modal dialogs for obtaining file names from the user. These classes are OpenFileDialog, which is designed to obtain the name of a file to read, and SaveFileDialog, which is designed to obtain the name of a file to write. Because we often need to obtain the name of a file prior to doing file I/O, it is appropriate to consider these classes now."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis300/io/dialogs/file-dialogs/embed.html"><meta property="og:site_name" content="Data Structures in C#"><meta property="og:title" content="File Dialogs :: Data Structures in C#"><meta property="og:description" content="File Dialogs The System.Windows.Forms namespace contains two other classes that implement modal dialogs for obtaining file names from the user. These classes are OpenFileDialog, which is designed to obtain the name of a file to read, and SaveFileDialog, which is designed to obtain the name of a file to write. Because we often need to obtain the name of a file prior to doing file I/O, it is appropriate to consider these classes now."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="Input/Output"><meta property="article:modified_time" content="2023-05-30T14:31:54-05:00"><meta itemprop=name content="File Dialogs :: Data Structures in C#"><meta itemprop=description content="File Dialogs The System.Windows.Forms namespace contains two other classes that implement modal dialogs for obtaining file names from the user. These classes are OpenFileDialog, which is designed to obtain the name of a file to read, and SaveFileDialog, which is designed to obtain the name of a file to write. Because we often need to obtain the name of a file prior to doing file I/O, it is appropriate to consider these classes now."><meta itemprop=dateModified content="2023-05-30T14:31:54-05:00"><meta itemprop=wordCount content="773"><title>File Dialogs :: Data Structures in C#</title>
<link href=/cis300/css/fontawesome-all.min.css?1723840624 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis300/css/fontawesome-all.min.css?1723840624 rel=stylesheet></noscript><link href=/cis300/css/nucleus.css?1723840624 rel=stylesheet><link href=/cis300/css/auto-complete.css?1723840624 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis300/css/auto-complete.css?1723840624 rel=stylesheet></noscript><link href=/cis300/css/perfect-scrollbar.min.css?1723840624 rel=stylesheet><link href=/cis300/css/fonts.css?1723840624 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis300/css/fonts.css?1723840624 rel=stylesheet></noscript><link href=/cis300/css/theme.css?1723840624 rel=stylesheet><link href=/cis300/css/theme-light-theme.css?1723840624 rel=stylesheet id=R-variant-style><link href=/cis300/css/chroma-relearn-light.css?1723840624 rel=stylesheet id=R-variant-chroma-style><link href=/cis300/css/variant.css?1723840624 rel=stylesheet><link href=/cis300/css/print.css?1723840624 rel=stylesheet media=print><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis300",window.index_js_url="/cis300/index.search.js",window.variants&&variants.init(["light-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis300/css/custom.css?1723840624 rel=stylesheet></head><body class="mobile-support embed disableInlineCopyToClipboard" data-url=/cis300/io/dialogs/file-dialogs/embed.html><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><h2 id=file-dialogs>File Dialogs</h2><p>The <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms?view=windowsdesktop-6.0" rel=external target=_blank><strong>System.Windows.Forms</strong></a> namespace contains two other classes that implement modal dialogs for obtaining file names from the user. These classes are <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.openfiledialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>OpenFileDialog</strong></a>, which is designed to obtain the name of a file to read, and <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.savefiledialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>SaveFileDialog</strong></a>, which is designed to obtain the name of a file to write. Because we often need to obtain the name of a file prior to doing file I/O, it is appropriate to consider these classes now.</p><p>Although these dialogs are visually separate from the window from which they are opened, it is possible (and usually desirable) to add instances of these classes to a form from <a href=/cis300/appendix/vs/design-window/>the Design window</a>. Both can be found in the &ldquo;Dialogs&rdquo; section of the Toolbox. They can be added to the form simply by double-clicking on their names. They will not appear on the form itself, but in a separate area of the Design window. Their properties can then be modified in the same way as any other control. We will discuss some of these properties a bit later in what follows.</p><p>Each of these classes has a method called <strong>ShowDialog</strong> that takes no parameters. For example, if we call the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.commondialog.showdialog?view=windowsdesktop-6.0#system-windows-forms-commondialog-showdialog" rel=external target=_blank><strong>ShowDialog</strong></a> method of an <strong>OpenFileDialog</strong>, a dialog resembling the following will be opened:</p><img src=open-file-dialog.png alt="An OpenFileDialog." style=zoom:67%><p>Similarly, calling the <strong>ShowDialog</strong> method of a <strong>SaveFileDialog</strong> opens a dialog resembling the following:</p><img src=save-file-dialog.png alt="A SaveFileDialog." style=zoom:67%><p>Because these dialogs are modal, the method call will not return until the user closes the dialog. It will then return a <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.dialogresult?view=windowsdesktop-6.0" rel=external target=_blank><strong>DialogResult</strong></a> indicating how the user closed the form - either <strong>DialogResult.OK</strong> or <strong>DialogResult.Cancel</strong> (see <a href=/cis300/io/dialogs/message-boxes/>the previous section</a> for more information on the <strong>DialogResult</strong> type). Therefore, if <code>uxFileDialog</code> is a variable referring to a file dialog, we typically use the following code template to display it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>uxFileDialog</span><span class=p>.</span><span class=n>ShowDialog</span><span class=p>()</span> <span class=p>==</span> <span class=n>DialogResult</span><span class=p>.</span><span class=n>OK</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Process the file</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Thus, if the user selects a file, we process it; otherwise, we do nothing. In some cases, we might include an <strong>else</strong> containing code that needs to be executed if the user closes the dialog without selecting a file.</p><p>Processing a file will be discussed in the three sections that follow. However, one thing we will certainly want to do prior to processing the file is to obtain the file name that the user selected (after all, this is the reason we display a file dialog). We can obtain this file name via the dialog&rsquo;s <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.filename?view=windowsdesktop-6.0#system-windows-forms-filedialog-filename" rel=external target=_blank><strong>FileName</strong></a> <a href=/cis300/appendix/syntax/properties/>property</a>; for example,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>string</span> <span class=n>fileName</span> <span class=p>=</span> <span class=n>uxFileDialog</span><span class=p>.</span><span class=n>FileName</span><span class=p>;</span></span></span></code></pre></div><p>Note that this and other properties are accessible for initialization purposes through a file dialog&rsquo;s Properties window in the Designer. This is useful for an <strong>OpenFileDialog</strong>&rsquo;s <strong>FileName</strong> property, as the default supplied by Visual Studio® is rather odd. Other properties that we might want to initialize here (in addition to <strong>(Name)</strong>, the name of the variable referring to the dialog) include:</p><ul><li><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.title?view=windowsdesktop-6.0" rel=external target=_blank><strong>Title</strong></a>, the title of the dialog (by default, &ldquo;Open&rdquo; for an <strong>OpenFileDialog</strong> or &ldquo;Save As&rdquo; for a <strong>SaveFileDialog</strong>).</p></li><li><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.filter?view=windowsdesktop-6.0" rel=external target=_blank><strong>Filter</strong></a>, a <em>filter string</em>, which controls what file types will be displayed. An example of a filter string is: <code>C# files|*.cs|All files|*.*</code>. A filter string consists of an even number of components separated by vertical bars ("|"). Thus, the above filter string consists of four components. These components are grouped into pairs. The first component of each pair gives the string that will be displayed in the dialog to describe what files are displayed. The second component of each pair describes a pattern of file names to be displayed when the first component of that pair is shown. Use an asterisk ("*") in a pattern to denote any sequence of characters. The &ldquo;.&rdquo; in a pattern ending in &ldquo;.*&rdquo; does not need to be matched - a file without an extension will be listed if it matches the pattern to the left of the &ldquo;.&rdquo;. Multiple patterns, separated by semicolons (";"), may be listed in one component. Thus, the above filter string describes two filters that the user may choose from. The first filter is labeled, &ldquo;C# files&rdquo;, and lists all files ending in &ldquo;.cs&rdquo;. The second filter is labeled &ldquo;All files&rdquo;, and lists all files.</p></li><li><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.filterindex?view=windowsdesktop-6.0" rel=external target=_blank><strong>FilterIndex</strong></a> indicates which pair in the filter string is currently being used. Note that the first pair has an index of 1, not 0.</p></li><li><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.addextension?view=windowsdesktop-6.0" rel=external target=_blank><strong>AddExtension</strong></a> and <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.defaultext?view=windowsdesktop-6.0" rel=external target=_blank><strong>DefaultExt</strong></a> control the dialog&rsquo;s behavior when the user types in a file name without an extension. When this happens, if a filter with a unique extension is chosen, that extension will be appended, regardless of the values of these two properties. Otherwise, if <strong>AddExtension</strong> is <strong>True</strong>, the value of <strong>DefaultExt</strong> will be appended, following a &ldquo;.&rdquo;.</p></li></ul><p>Other properties allow further customization of file dialogs. For more
details, see the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.openfiledialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>OpenFileDialog</strong></a> and <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.savefiledialog?view=windowsdesktop-6.0" rel=external target=_blank><strong>SaveFileDialog</strong></a> documentation.</p><footer class=footline></footer></article></div></main></div><script src=/cis300/js/clipboard.min.js?1723840624 defer></script><script src=/cis300/js/perfect-scrollbar.min.js?1723840624 defer></script><script src=/cis300/js/theme.js?1723840624 defer></script><script src=/cis300/js/embed-iframe.js?1723840624 defer></script></body></html>